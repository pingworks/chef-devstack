# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
auto eth0
iface eth0 inet static
	address <%= node['devstack']['external_iface_ip'] %>
	netmask <%= node['devstack']['external_iface_nm'] %>
	gateway <%= node['devstack']['global_gw_ip'] %>

<% if node['devstack']['type']=='ctrl' -%>
auto br-ex
iface br-ex inet static
	address <%= node['devstack']['router_public_gw'] %>
	netmask <%= node['devstack']['router_public_nm'] %>
	up   ip route add <%= node['devstack']['router_private_network'] %> via <%= node['devstack']['router_public_ip'] %> dev $IFACE
	down ip route del <%= node['devstack']['router_private_network'] %> via <%= node['devstack']['router_public_ip'] %> dev $IFACE
<% end -%>

<% if node['devstack']['type']=='gateway' %>
auto wlan0
iface wlan0 inet dhcp
	wpa-conf /etc/wpa_supplicant/wpa.conf
<% end -%>
